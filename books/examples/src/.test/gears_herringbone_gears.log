
-- Test --
        Test name: gears_herringbone_gears
  Expected result: ok
      Source file: ../books/examples/src/gears.md:96
        Test path: ../books/examples/src/.test

-- Code --

  96:   // file: herringbone_gears
  97:   // Copyright © 2025 The µcad authors <info@ucad.xyz>
  98:   // SPDX-License-Identifier: AGPL-3.0-or-later
  99:   
 100:   use std::ops::*;
 101:   use std::geo2d::*;
 102:   use std::math::*;
 103:   
 104:   part Gear(teeth: Integer)  {
 105:       gear_profile = InvoluteGearProfile(1.5mm, teeth);
 106:       prop outer_radius = gear_profile.outer_radius;
 107:       prop pitch_radius = gear_profile.pitch_radius;
 108:       prop tooth_angle = gear_profile.tooth_angle;
 109:       prop tooth_distance = gear_profile.tooth_distance;
 110:       prop module = gear_profile.module;
 111:   
 112:       disc = Circle(pitch_radius - module * 400%);
 113:       web = {
 114:           sector = Sector(disc.radius, 360° / 5)
 115:               .buffer(-disc.radius * 15%)
 116:               .buffer(disc.radius * 12%);
 117:           holes = (sector - Circle(module * 1000%))
 118:               .rotate([0..4] * 360° / 5);
 119:           hub = InvoluteGearProfile(2.5mm, 7);
 120:           disc - holes - hub;
 121:       }.extrude(tooth_distance * 300%).center();
 122:   
 123:       rim = (gear_profile - disc)
 124:           .extrude(tooth_distance * 200%, tooth_angle)
 125:           .mirror(-Z);
 126:   
 127:       web | rim;
 128:   }
 129:   
 130:   gear1 = Gear(90);
 131:   gear2 = Gear(60);
 132:   
 133:   gear1.reflect(X);
 134:   gear2
 135:       .rotate(gear2.tooth_angle * 50%)
 136:       .translate(gear1.outer_radius + gear2.pitch_radius, [1..3] * 360° / 3);
 137:   
 138:   
 139:   

