
-- Test --
        Test name: gears_gears_3d
  Expected result: ok
      Source file: ../books/examples/src/gears.md:30
        Test path: ../books/examples/src/.test

-- Code --

  30:   // file: gears_3d.µcad
  31:   // Copyright © 2025 The µcad authors <info@ucad.xyz>
  32:   // SPDX-License-Identifier: AGPL-3.0-or-later
  33:   
  34:   use std::ops::*;
  35:   use std::geo2d::*;
  36:   use std::math::*;
  37:   
  38:   const TEETH = 20;
  39:   
  40:   angle = 30° * TEETH;
  41:   
  42:   part Gear(teeth: Integer) {
  43:       gear_profile = InvoluteGearProfile(module = 1.0mm, teeth);
  44:   
  45:       prop pitch_radius = gear_profile.pitch_radius;
  46:       prop outer_radius = gear_profile.outer_radius;
  47:   
  48:       n_holes = 5;
  49:   
  50:       bearing_hole = Circle(gear_profile.pitch_radius / 8);
  51:       
  52:       hole_radius = pitch_radius / n_holes;
  53:       holes = Circle(pitch_radius / n_holes).translate(x = outer_radius - hole_radius * 2).rotate([1..n_holes] * 360° / n_holes);
  54:   
  55:       inner = Circle(pitch_radius - 3mm);
  56:   
  57:       bearing = (Circle(pitch_radius / 4) - bearing_hole).extrude(8mm) - 
  58:           Circle(gear_profile.module)
  59:               .extrude(pitch_radius / 4)
  60:               .translate(z = -pitch_radius / 4).rotate(x = 90°).translate(z = 5mm);
  61:   
  62:       bearing | (inner - holes - Circle(pitch_radius / 4)).extrude(2mm) | (gear_profile - inner).extrude(4mm);
  63:   }
  64:   
  65:   
  66:   gear1 = Gear(80);
  67:   gear2 = Gear(40);
  68:   gear3 = Gear(20);
  69:   
  70:   #[color = std::color::BLUE]
  71:   #[export = "gear1.stl"]
  72:   gear1.rotate(angle / gear1.teeth);
  73:   
  74:   #[color = std::color::RED]
  75:   #[export = "gear2.stl"]
  76:   gear2.rotate(-angle / gear2.teeth + 360°/gear2.teeth/2.0).translate(gear2.outer_radius + gear1.pitch_radius, 135°);
  77:   
  78:   #[color = std::color::GREEN]
  79:   #[export = "gear3.stl"]
  80:   gear3.rotate(-angle / gear3.teeth).translate(gear1.outer_radius + gear3.pitch_radius, 45°);
  81:   
  82:   

-- No Output --
-- Errors --
  × error: 21:27: Workbench Circle has ambiguous initialization for those arguments
    ╭─[../books/examples/src/gears.md:50:20]
 49 │ 
 50 │     bearing_hole = Circle(gear_profile.pitch_radius / 8);
    ·                    ──────────────────┬──────────────────
    ·                                      ╰── Got: Circle( 5mm )
 51 │     
    ╰────
  help: Ambiguous initializations:
        	std::geo2d::Circle(radius: Length, center = (x = 0mm, y = 0mm))
        	std::geo2d::Circle::init(diameter: Length, center = (x = 0mm, y = 0mm))
  × error: 24:20: Workbench Circle has ambiguous initialization for those arguments
    ╭─[../books/examples/src/gears.md:53:13]
 52 │     hole_radius = pitch_radius / n_holes;
 53 │     holes = Circle(pitch_radius / n_holes).translate(x = outer_radius - hole_radius * 2).rotate([1..n_holes] * 360° / n_holes);
    ·             ───────────────┬──────────────
    ·                            ╰── Got: Circle( 8mm )
 54 │ 
    ╰────
  help: Ambiguous initializations:
        	std::geo2d::Circle(radius: Length, center = (x = 0mm, y = 0mm))
        	std::geo2d::Circle::init(diameter: Length, center = (x = 0mm, y = 0mm))
  ⚠ warning: 24:13: This expression statement did not produce any model
    ╭─[../books/examples/src/gears.md:53:13]
 52 │     hole_radius = pitch_radius / n_holes;
 53 │     holes = Circle(pitch_radius / n_holes).translate(x = outer_radius - hole_radius * 2).rotate([1..n_holes] * 360° / n_holes);
    ·             ───────────────┬──────────────
    ·                            ╰── warning: 24:13: This expression statement did not produce any model
 54 │ 
    ╰────
  × error: 26:20: Workbench Circle has ambiguous initialization for those arguments
    ╭─[../books/examples/src/gears.md:55:13]
 54 │ 
 55 │     inner = Circle(pitch_radius - 3mm);
    ·             ─────────────┬────────────
    ·                          ╰── Got: Circle( pitch_radius = 37mm )
 56 │ 
    ╰────
  help: Ambiguous initializations:
        	std::geo2d::Circle(radius: Length, center = (x = 0mm, y = 0mm))
        	std::geo2d::Circle::init(diameter: Length, center = (x = 0mm, y = 0mm))
  × error: 28:23: Workbench Circle has ambiguous initialization for those arguments
    ╭─[../books/examples/src/gears.md:57:16]
 56 │ 
 57 │     bearing = (Circle(pitch_radius / 4) - bearing_hole).extrude(8mm) - 
    ·                ────────────┬───────────
    ·                            ╰── Got: Circle( pitch_radius = 10mm )
 58 │         Circle(gear_profile.module)
    ╰────
  help: Ambiguous initializations:
        	std::geo2d::Circle(radius: Length, center = (x = 0mm, y = 0mm))
        	std::geo2d::Circle::init(diameter: Length, center = (x = 0mm, y = 0mm))
  × error: 29:16: Workbench Circle has ambiguous initialization for those arguments
    ╭─[../books/examples/src/gears.md:58:9]
 57 │     bearing = (Circle(pitch_radius / 4) - bearing_hole).extrude(8mm) - 
 58 │         Circle(gear_profile.module)
    ·         ─────────────┬─────────────
    ·                      ╰── Got: Circle( 1mm )
 59 │             .extrude(pitch_radius / 4)
    ╰────
  help: Ambiguous initializations:
        	std::geo2d::Circle(radius: Length, center = (x = 0mm, y = 0mm))
        	std::geo2d::Circle::init(diameter: Length, center = (x = 0mm, y = 0mm))
  ⚠ warning: 29:9: This expression statement did not produce any model
    ╭─[../books/examples/src/gears.md:58:9]
 57 │     bearing = (Circle(pitch_radius / 4) - bearing_hole).extrude(8mm) - 
 58 │         Circle(gear_profile.module)
    ·         ─────────────┬─────────────
    ·                      ╰── warning: 29:9: This expression statement did not produce any model
 59 │             .extrude(pitch_radius / 4)
    ╰────
  × error: 33:39: Workbench Circle has ambiguous initialization for those arguments
    ╭─[../books/examples/src/gears.md:62:32]
 61 │ 
 62 │     bearing | (inner - holes - Circle(pitch_radius / 4)).extrude(2mm) | (gear_profile - inner).extrude(4mm);
    ·                                ────────────┬───────────
    ·                                            ╰── Got: Circle( pitch_radius = 10mm )
 63 │ }
    ╰────
  help: Ambiguous initializations:
        	std::geo2d::Circle(radius: Length, center = (x = 0mm, y = 0mm))
        	std::geo2d::Circle::init(diameter: Length, center = (x = 0mm, y = 0mm))
  × error: 21:27: Workbench Circle has ambiguous initialization for those arguments
    ╭─[../books/examples/src/gears.md:50:20]
 49 │ 
 50 │     bearing_hole = Circle(gear_profile.pitch_radius / 8);
    ·                    ──────────────────┬──────────────────
    ·                                      ╰── Got: Circle( 2.5mm )
 51 │     
    ╰────
  help: Ambiguous initializations:
        	std::geo2d::Circle(radius: Length, center = (x = 0mm, y = 0mm))
        	std::geo2d::Circle::init(diameter: Length, center = (x = 0mm, y = 0mm))
  × error: 24:20: Workbench Circle has ambiguous initialization for those arguments
    ╭─[../books/examples/src/gears.md:53:13]
 52 │     hole_radius = pitch_radius / n_holes;
 53 │     holes = Circle(pitch_radius / n_holes).translate(x = outer_radius - hole_radius * 2).rotate([1..n_holes] * 360° / n_holes);
    ·             ───────────────┬──────────────
    ·                            ╰── Got: Circle( 4mm )
 54 │ 
    ╰────
  help: Ambiguous initializations:
        	std::geo2d::Circle(radius: Length, center = (x = 0mm, y = 0mm))
        	std::geo2d::Circle::init(diameter: Length, center = (x = 0mm, y = 0mm))
  ⚠ warning: 24:13: This expression statement did not produce any model
    ╭─[../books/examples/src/gears.md:53:13]
 52 │     hole_radius = pitch_radius / n_holes;
 53 │     holes = Circle(pitch_radius / n_holes).translate(x = outer_radius - hole_radius * 2).rotate([1..n_holes] * 360° / n_holes);
    ·             ───────────────┬──────────────
    ·                            ╰── warning: 24:13: This expression statement did not produce any model
 54 │ 
    ╰────
  × error: 26:20: Workbench Circle has ambiguous initialization for those arguments
    ╭─[../books/examples/src/gears.md:55:13]
 54 │ 
 55 │     inner = Circle(pitch_radius - 3mm);
    ·             ─────────────┬────────────
    ·                          ╰── Got: Circle( pitch_radius = 17mm )
 56 │ 
    ╰────
  help: Ambiguous initializations:
        	std::geo2d::Circle(radius: Length, center = (x = 0mm, y = 0mm))
        	std::geo2d::Circle::init(diameter: Length, center = (x = 0mm, y = 0mm))
  × error: 28:23: Workbench Circle has ambiguous initialization for those arguments
    ╭─[../books/examples/src/gears.md:57:16]
 56 │ 
 57 │     bearing = (Circle(pitch_radius / 4) - bearing_hole).extrude(8mm) - 
    ·                ────────────┬───────────
    ·                            ╰── Got: Circle( pitch_radius = 5mm )
 58 │         Circle(gear_profile.module)
    ╰────
  help: Ambiguous initializations:
        	std::geo2d::Circle(radius: Length, center = (x = 0mm, y = 0mm))
        	std::geo2d::Circle::init(diameter: Length, center = (x = 0mm, y = 0mm))
  × error: 29:16: Workbench Circle has ambiguous initialization for those arguments
    ╭─[../books/examples/src/gears.md:58:9]
 57 │     bearing = (Circle(pitch_radius / 4) - bearing_hole).extrude(8mm) - 
 58 │         Circle(gear_profile.module)
    ·         ─────────────┬─────────────
    ·                      ╰── Got: Circle( 1mm )
 59 │             .extrude(pitch_radius / 4)
    ╰────
  help: Ambiguous initializations:
        	std::geo2d::Circle(radius: Length, center = (x = 0mm, y = 0mm))
        	std::geo2d::Circle::init(diameter: Length, center = (x = 0mm, y = 0mm))
  ⚠ warning: 29:9: This expression statement did not produce any model
    ╭─[../books/examples/src/gears.md:58:9]
 57 │     bearing = (Circle(pitch_radius / 4) - bearing_hole).extrude(8mm) - 
 58 │         Circle(gear_profile.module)
    ·         ─────────────┬─────────────
    ·                      ╰── warning: 29:9: This expression statement did not produce any model
 59 │             .extrude(pitch_radius / 4)
    ╰────
  × error: 33:39: Workbench Circle has ambiguous initialization for those arguments
    ╭─[../books/examples/src/gears.md:62:32]
 61 │ 
 62 │     bearing | (inner - holes - Circle(pitch_radius / 4)).extrude(2mm) | (gear_profile - inner).extrude(4mm);
    ·                                ────────────┬───────────
    ·                                            ╰── Got: Circle( pitch_radius = 5mm )
 63 │ }
    ╰────
  help: Ambiguous initializations:
        	std::geo2d::Circle(radius: Length, center = (x = 0mm, y = 0mm))
        	std::geo2d::Circle::init(diameter: Length, center = (x = 0mm, y = 0mm))
  × error: 21:27: Workbench Circle has ambiguous initialization for those arguments
    ╭─[../books/examples/src/gears.md:50:20]
 49 │ 
 50 │     bearing_hole = Circle(gear_profile.pitch_radius / 8);
    ·                    ──────────────────┬──────────────────
    ·                                      ╰── Got: Circle( 1.25mm )
 51 │     
    ╰────
  help: Ambiguous initializations:
        	std::geo2d::Circle(radius: Length, center = (x = 0mm, y = 0mm))
        	std::geo2d::Circle::init(diameter: Length, center = (x = 0mm, y = 0mm))
  × error: 24:20: Workbench Circle has ambiguous initialization for those arguments
    ╭─[../books/examples/src/gears.md:53:13]
 52 │     hole_radius = pitch_radius / n_holes;
 53 │     holes = Circle(pitch_radius / n_holes).translate(x = outer_radius - hole_radius * 2).rotate([1..n_holes] * 360° / n_holes);
    ·             ───────────────┬──────────────
    ·                            ╰── Got: Circle( 2mm )
 54 │ 
    ╰────
  help: Ambiguous initializations:
        	std::geo2d::Circle(radius: Length, center = (x = 0mm, y = 0mm))
        	std::geo2d::Circle::init(diameter: Length, center = (x = 0mm, y = 0mm))
  ⚠ warning: 24:13: This expression statement did not produce any model
    ╭─[../books/examples/src/gears.md:53:13]
 52 │     hole_radius = pitch_radius / n_holes;
 53 │     holes = Circle(pitch_radius / n_holes).translate(x = outer_radius - hole_radius * 2).rotate([1..n_holes] * 360° / n_holes);
    ·             ───────────────┬──────────────
    ·                            ╰── warning: 24:13: This expression statement did not produce any model
 54 │ 
    ╰────
  × error: 26:20: Workbench Circle has ambiguous initialization for those arguments
    ╭─[../books/examples/src/gears.md:55:13]
 54 │ 
 55 │     inner = Circle(pitch_radius - 3mm);
    ·             ─────────────┬────────────
    ·                          ╰── Got: Circle( pitch_radius = 7mm )
 56 │ 
    ╰────
  help: Ambiguous initializations:
        	std::geo2d::Circle(radius: Length, center = (x = 0mm, y = 0mm))
        	std::geo2d::Circle::init(diameter: Length, center = (x = 0mm, y = 0mm))
  × error: 28:23: Workbench Circle has ambiguous initialization for those arguments
    ╭─[../books/examples/src/gears.md:57:16]
 56 │ 
 57 │     bearing = (Circle(pitch_radius / 4) - bearing_hole).extrude(8mm) - 
    ·                ────────────┬───────────
    ·                            ╰── Got: Circle( pitch_radius = 2.5mm )
 58 │         Circle(gear_profile.module)
    ╰────
  help: Ambiguous initializations:
        	std::geo2d::Circle(radius: Length, center = (x = 0mm, y = 0mm))
        	std::geo2d::Circle::init(diameter: Length, center = (x = 0mm, y = 0mm))
  × error: 29:16: Workbench Circle has ambiguous initialization for those arguments
    ╭─[../books/examples/src/gears.md:58:9]
 57 │     bearing = (Circle(pitch_radius / 4) - bearing_hole).extrude(8mm) - 
 58 │         Circle(gear_profile.module)
    ·         ─────────────┬─────────────
    ·                      ╰── Got: Circle( 1mm )
 59 │             .extrude(pitch_radius / 4)
    ╰────
  help: Ambiguous initializations:
        	std::geo2d::Circle(radius: Length, center = (x = 0mm, y = 0mm))
        	std::geo2d::Circle::init(diameter: Length, center = (x = 0mm, y = 0mm))
  ⚠ warning: 29:9: This expression statement did not produce any model
    ╭─[../books/examples/src/gears.md:58:9]
 57 │     bearing = (Circle(pitch_radius / 4) - bearing_hole).extrude(8mm) - 
 58 │         Circle(gear_profile.module)
    ·         ─────────────┬─────────────
    ·                      ╰── warning: 29:9: This expression statement did not produce any model
 59 │             .extrude(pitch_radius / 4)
    ╰────
  × error: 33:39: Workbench Circle has ambiguous initialization for those arguments
    ╭─[../books/examples/src/gears.md:62:32]
 61 │ 
 62 │     bearing | (inner - holes - Circle(pitch_radius / 4)).extrude(2mm) | (gear_profile - inner).extrude(4mm);
    ·                                ────────────┬───────────
    ·                                            ╰── Got: Circle( pitch_radius = 2.5mm )
 63 │ }
    ╰────
  help: Ambiguous initializations:
        	std::geo2d::Circle(radius: Length, center = (x = 0mm, y = 0mm))
        	std::geo2d::Circle::init(diameter: Length, center = (x = 0mm, y = 0mm))
Unexpected error(s) which did occur in line(s): 50, 53, 55, 57, 58, 62
Unexpected warnings(s) which did occur in line(s): 53, 58
-- Test Result --
FAILS
