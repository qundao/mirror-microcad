-- Test --
  first_version
  ../books/tutorials/src/lego_brick/part/first.md:11

-- Code --

  11:   use std::ops::*;
  12:   use std::geo2d::*;
  13:   
  14:   const SPACING = 8mm;
  15:   
  16:   sketch Base(width: Length, height: Length) {
  17:       thickness = 1.2mm;
  18:       frame = Frame(width, height, thickness);
  19:       struts = Ring(outer_d = 6.51mm, inner_d = 4.8mm)
  20:           .translate(y = [0..2] * SPACING)
  21:           .center();
  22:       frame | struts;
  23:   }
  24:   
  25:   use Rect as Cap;
  26:   
  27:   sketch Knobs() {
  28:       center = (x = [0..1] * SPACING, y = [0..3] * SPACING);
  29:       Circle(diameter = 4.8mm, center).center();
  30:   }
  31:   
  32:   part LegoBrick(base_height = 9.6mm) {
  33:       width = 15.8mm;
  34:       height = 31.8mm;
  35:       top_thickness = 1.0mm;
  36:   
  37:       base = Base(width, height)
  38:           .extrude(base_height);
  39:   
  40:       cap = Cap(width, height)
  41:           .extrude(top_thickness)
  42:           .translate(z = base_height - top_thickness);
  43:   
  44:       knobs = Knobs()
  45:           .extrude(1.7mm)
  46:           .translate(z = base_height);
  47:   
  48:       // Combine all components
  49:       base | cap | knobs;
  50:   }
  51:   
  52:   LegoBrick();

-- Output --

-- Errors --
-- Model --
  Group (root) ->
    Workpiece(part) first_version::LegoBrick(base_height=9.6mm) ->
      - base_height = 9.6mm
      Operation union() ->
        Group ->
          Operation union() ->
            Group ->
              base: Workpiece(op) std::ops::extrude(height=9.6mm, scale=(x=1, y=1), twist=0rad) ->
                - height = 9.6mm
                - scale = (x=1, y=1)
                - twist = 0rad
                Operation __builtin::ops::extrude(height=9.6mm, scale_x=1, scale_y=1, twist=0rad) ->
                  Workpiece(sketch) first_version::Base(height=31.8mm, width=15.8mm) ->
                    - height = 31.8mm
                    - width = 15.8mm
                    Operation union() ->
                      Group ->
                        frame: Workpiece(sketch) std::geo2d::Frame(height=31.8mm, thickness=1.2mm, width=15.8mm) ->
                          - height = 31.8mm
                          - thickness = 1.2mm
                          - width = 15.8mm
                          Operation subtract() ->
                            Group ->
                              Workpiece(sketch) std::geo2d::Rect(height=31.8mm, width=15.8mm) ->
                                - height = 31.8mm
                                - width = 15.8mm
                                - x = -7.9mm
                                - y = -15.9mm
                                Primitive2D __builtin::geo2d::Rect(height=31.8mm, width=15.8mm, x=-7.9mm, y=-15.9mm) ->
                              Workpiece(sketch) std::geo2d::Rect(height=29.4mm, width=13.4mm) ->
                                - height = 29.4mm
                                - width = 13.4mm
                                - x = -6.7mm
                                - y = -14.7mm
                                Primitive2D __builtin::geo2d::Rect(height=29.4mm, width=13.4mm, x=-6.7mm, y=-14.7mm) ->
                        struts: Operation __builtin::ops::center() ->
                          Multiplicity ->
                            Workpiece(op) std::ops::translate(x=0mm, y=0mm, z=0mm) ->
                              - x = 0mm
                              - y = 0mm
                              - z = 0mm
                              Transform __builtin::ops::translate(x=0mm, y=0mm, z=0mm) ->
                                Workpiece(sketch) std::geo2d::Ring(inner_d=4.8mm, outer_d=6.51mm) ->
                                  - inner_r = 2.4mm
                                  - outer_r = 3.255mm
                                  Operation subtract() ->
                                    Group ->
                                      Workpiece(sketch) std::geo2d::Circle(center=(x=0mm, y=0mm), radius=3.255mm) ->
                                        - center = (x=0mm, y=0mm)
                                        - radius = 3.255mm
                                        Transform __builtin::ops::translate(x=0mm, y=0mm, z=0mm) ->
                                          Primitive2D __builtin::geo2d::Circle(radius=3.255mm) ->
                                      Workpiece(sketch) std::geo2d::Circle(center=(x=0mm, y=0mm), radius=2.4mm) ->
                                        - center = (x=0mm, y=0mm)
                                        - radius = 2.4mm
                                        Transform __builtin::ops::translate(x=0mm, y=0mm, z=0mm) ->
                                          Primitive2D __builtin::geo2d::Circle(radius=2.4mm) ->
                            Workpiece(op) std::ops::translate(x=0mm, y=8mm, z=0mm) ->
                              - x = 0mm
                              - y = 8mm
                              - z = 0mm
                              Transform __builtin::ops::translate(x=0mm, y=8mm, z=0mm) ->
                                Workpiece(sketch) std::geo2d::Ring(inner_d=4.8mm, outer_d=6.51mm) ->
                                  - inner_r = 2.4mm
                                  - outer_r = 3.255mm
                                  Operation subtract() ->
                                    Group ->
                                      Workpiece(sketch) std::geo2d::Circle(center=(x=0mm, y=0mm), radius=3.255mm) ->
                                        - center = (x=0mm, y=0mm)
                                        - radius = 3.255mm
                                        Transform __builtin::ops::translate(x=0mm, y=0mm, z=0mm) ->
                                          Primitive2D __builtin::geo2d::Circle(radius=3.255mm) ->
                                      Workpiece(sketch) std::geo2d::Circle(center=(x=0mm, y=0mm), radius=2.4mm) ->
                                        - center = (x=0mm, y=0mm)
                                        - radius = 2.4mm
                                        Transform __builtin::ops::translate(x=0mm, y=0mm, z=0mm) ->
                                          Primitive2D __builtin::geo2d::Circle(radius=2.4mm) ->
                            Workpiece(op) std::ops::translate(x=0mm, y=16mm, z=0mm) ->
                              - x = 0mm
                              - y = 16mm
                              - z = 0mm
                              Transform __builtin::ops::translate(x=0mm, y=16mm, z=0mm) ->
                                Workpiece(sketch) std::geo2d::Ring(inner_d=4.8mm, outer_d=6.51mm) ->
                                  - inner_r = 2.4mm
                                  - outer_r = 3.255mm
                                  Operation subtract() ->
                                    Group ->
                                      Workpiece(sketch) std::geo2d::Circle(center=(x=0mm, y=0mm), radius=3.255mm) ->
                                        - center = (x=0mm, y=0mm)
                                        - radius = 3.255mm
                                        Transform __builtin::ops::translate(x=0mm, y=0mm, z=0mm) ->
                                          Primitive2D __builtin::geo2d::Circle(radius=3.255mm) ->
                                      Workpiece(sketch) std::geo2d::Circle(center=(x=0mm, y=0mm), radius=2.4mm) ->
                                        - center = (x=0mm, y=0mm)
                                        - radius = 2.4mm
                                        Transform __builtin::ops::translate(x=0mm, y=0mm, z=0mm) ->
                                          Primitive2D __builtin::geo2d::Circle(radius=2.4mm) ->
              cap: Workpiece(op) std::ops::translate(x=0mm, y=0mm, z=8.6mm) ->
                - x = 0mm
                - y = 0mm
                - z = 8.6mm
                Transform __builtin::ops::translate(x=0mm, y=0mm, z=8.6mm) ->
                  Workpiece(op) std::ops::extrude(height=1mm, scale=(x=1, y=1), twist=0rad) ->
                    - height = 1mm
                    - scale = (x=1, y=1)
                    - twist = 0rad
                    Operation __builtin::ops::extrude(height=1mm, scale_x=1, scale_y=1, twist=0rad) ->
                      Workpiece(sketch) std::geo2d::Rect(height=31.8mm, width=15.8mm) ->
                        - height = 31.8mm
                        - width = 15.8mm
                        - x = -7.9mm
                        - y = -15.9mm
                        Primitive2D __builtin::geo2d::Rect(height=31.8mm, width=15.8mm, x=-7.9mm, y=-15.9mm) ->
          knobs: Workpiece(op) std::ops::translate(x=0mm, y=0mm, z=9.6mm) ->
            - x = 0mm
            - y = 0mm
            - z = 9.6mm
            Transform __builtin::ops::translate(x=0mm, y=0mm, z=9.6mm) ->
              Workpiece(op) std::ops::extrude(height=1.7mm, scale=(x=1, y=1), twist=0rad) ->
                - height = 1.7mm
                - scale = (x=1, y=1)
                - twist = 0rad
                Operation __builtin::ops::extrude(height=1.7mm, scale_x=1, scale_y=1, twist=0rad) ->
                  Workpiece(sketch) first_version::Knobs() ->
                    Operation __builtin::ops::center() ->
                      Workpiece(sketch) std::geo2d::Circle(center=(x=[0mm, 8mm], y=[0mm, 8mm, 16mm, 24mm]), diameter=4.8mm) ->
                        - center = (x=[0mm, 8mm], y=[0mm, 8mm, 16mm, 24mm])
                        - radius = 2.4mm
                        Multiplicity ->
                          Transform __builtin::ops::translate(x=0mm, y=0mm, z=0mm) ->
                            Primitive2D __builtin::geo2d::Circle(radius=2.4mm) ->
                          Transform __builtin::ops::translate(x=8mm, y=0mm, z=0mm) ->
                            Primitive2D __builtin::geo2d::Circle(radius=2.4mm) ->
                          Transform __builtin::ops::translate(x=0mm, y=8mm, z=0mm) ->
                            Primitive2D __builtin::geo2d::Circle(radius=2.4mm) ->
                          Transform __builtin::ops::translate(x=8mm, y=8mm, z=0mm) ->
                            Primitive2D __builtin::geo2d::Circle(radius=2.4mm) ->
                          Transform __builtin::ops::translate(x=0mm, y=16mm, z=0mm) ->
                            Primitive2D __builtin::geo2d::Circle(radius=2.4mm) ->
                          Transform __builtin::ops::translate(x=8mm, y=16mm, z=0mm) ->
                            Primitive2D __builtin::geo2d::Circle(radius=2.4mm) ->
                          Transform __builtin::ops::translate(x=0mm, y=24mm, z=0mm) ->
                            Primitive2D __builtin::geo2d::Circle(radius=2.4mm) ->
                          Transform __builtin::ops::translate(x=8mm, y=24mm, z=0mm) ->
                            Primitive2D __builtin::geo2d::Circle(radius=2.4mm) ->

Export of "../books/tutorials/src/lego_brick/part/.test/first_version-out.stl" successful.
-- Test Result --
OK
